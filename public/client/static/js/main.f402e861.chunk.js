(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{29:function(e,t,a){e.exports=a(43)},34:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(16),c=a.n(l),i=(a(34),a(45)),o=(a(7),a(1)),s=a.n(o),u=a(3),m=a(2),d=a(5),p=a(12),f=a(18),y=a(6),h=a(14),g=a.n(h),b=function(e,t){if(!e)return{loginStatus:""};if(localStorage.authToken&&"CHECK_LOGIN"==t.type&&null!==localStorage.authToken){var a=g()(localStorage.authToken);return Object(y.a)(Object(y.a)({},e),{},{username:a.username,id:a.sub,birthday:a.birthday})}if("LOGIN"==t.type){var n=g()(t.token);return localStorage.setItem("authToken","".concat(t.token)),Object(y.a)(Object(y.a)({},e),{},{username:n.username,id:n.sub,birthday:n.birthday})}return"LOGOUT"==t.type&&localStorage.removeItem("authToken"),"LOGIN_STATUS"==t.type?Object(y.a)(Object(y.a)({},e),{},{loginStatus:t.status}):e},E=function(e,t){if(!e)return{isMuted:!1,volume:.5,currentTime:"0:00",isItPlaying:!1,duration:"",isPlaying:!1,playingTrack:{id:null,index:null},playlist:null};if("SET_PLAYLIST"==t.type){var a=t.playlist;return Object(y.a)(Object(y.a)({},e),{},{playlist:a})}if("PLAY_TRACK"==t.type){var n=t.index,r=t.id;return e.playingTrack.index=n,e.playingTrack.id=r,e}if("CURRENT_TIME"==t.type){var l=t.currentTime;return Object(y.a)(Object(y.a)({},e),{},{currentTime:l})}if("LOAD_METADATA"==t.type){var c=t.duration;return Object(y.a)(Object(y.a)({},e),{},{duration:c})}return"PLAY"==t.type?Object(y.a)(Object(y.a)({},e),{},{isPlaying:!0}):"PAUSE"==t.type?Object(y.a)(Object(y.a)({},e),{},{isPlaying:!1}):"SET_PLAYER_PLAY"==t.type?Object(y.a)(Object(y.a)({},e),{},{isItPlaying:t.isItPlaying}):e},k=Object(p.d)(Object(p.c)({login:b,trackChange:E}),Object(p.a)(f.a)),v=(0,a(11).createBrowserHistory)(),O={play:function(){k.dispatch({type:"PLAY"})},pause:function(){k.dispatch({type:"PAUSE"})},playlist:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];k.dispatch({type:"SET_PLAYLIST",playlist:e})},loadMetadata:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";k.dispatch({type:"LOAD_METADATA",duration:e})},updataTime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";k.dispatch({type:"CURRENT_TIME",currentTime:e})},playTrack:function(e,t){k.dispatch({type:"PLAY_TRACK",index:e,id:t})},setPlay:function(e){k.dispatch({type:"SET_PLAYER_PLAY",isItPlaying:e})}};var T=Object(d.b)((function(e){return{playlist:e.trackChange.playlist,current:e.trackChange.playingTrack.index,isplaying:e.trackChange.isPlaying,duraTion:e.trackChange.duration,toggleStop:e.trackChange.doToggleStop,currentId:e.trackChange.playingTrack.id}}))((function(e){var t=e.playlist,a=e.current,l=e.isplaying,c=(e.shuffle,e.duraTion),i=(e.currentId,e.noshuffle,Object(n.useState)()),o=Object(m.a)(i,2),s=o[0],u=o[1],d=Object(n.useState)("black"),p=Object(m.a)(d,2),f=p[0],y=p[1],h=Object(n.useState)(),g=Object(m.a)(h,2),b=g[0],E=g[1],k=Object(n.useState)(),v=Object(m.a)(k,2),T=v[0],x=v[1],j=Object(n.useState)(),N=Object(m.a)(j,2),w=N[0],C=N[1],I=Object(n.useState)(50),P=Object(m.a)(I,2),A=P[0],q=P[1],M=Object(n.useState)(!1),L=Object(m.a)(M,2),F=L[0],z=L[1];window.onkeydown=function(e){13==e.keyCode&&l?(O.pause(),s.pause()):13!=e.keyCode||l||(O.play(),s.play()),39==e.keyCode&&B(),37==e.keyCode&&_(),220==e.keyCode&&(s.pause(),O.pause(),s.src="/song/".concat(t[a].filename),s.play(),O.play())};Object(n.useEffect)((function(){return function(){if(t&&a||0===a){var e=new Audio("/song/".concat(t[a].filename));e.load(),e.autoplay=!1,e.onloadedmetadata=function(){E(e.duration),e.volume=.5},e.ontimeupdate=function(n){x(n.target.currentTime);var r,l="\n".concat(parseInt(n.target.currentTime/60),":").concat(Math.round(n.target.currentTime)%60<10?"0"+Math.round(n.target.currentTime)%60:parseInt(n.target.currentTime)%60);O.updataTime(l),document.getElementById("bar")&&(r=document.getElementById("bar").offsetWidth,console.log(r)),C(parseInt(n.target.currentTime*r/n.target.duration)),e.ended&&!e.loop&&a!=t.length-1?(a+=1,n.target.src="/song/".concat(t[a].filename),O.playTrack(a,t[a].id),n.target.play(),O.play()):e.ended&&!e.loop&&a==t.length-1?(a=0,n.target.src="/song/".concat(t[a].filename),O.playTrack(a,t[a].id),n.target.play(),O.play()):e.ended&&(C(0),x(0))},u(e),e.play(),O.play()}}()}),[]);var B=function(){a==t.length-1?(a=0,O.playTrack(a,t[a].id),s.src="/song/".concat(t[a].filename),O.play(),s.play()):(O.playTrack(a+1,t[a+1].id),s.src="/song/".concat(t[a+1].filename),O.play(),s.play())},_=function(){0==a?(a=t.length-1,O.playTrack(a,t[a].id),s.src="/song/".concat(t[a].filename),O.play(),s.play()):(O.playTrack(a-1,t[a-1].id),s.src="/song/".concat(t[a-1].filename),O.play(),s.play())};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"player-box",style:{display:a||0==a?"block":"none"}},r.a.createElement("div",{className:"MainPlayer"},r.a.createElement("div",{className:"mainplayer-tools"},r.a.createElement("i",{className:"fa fa-backward  player-btn",onClick:_}),l?r.a.createElement("span",{onClick:function(){O.pause(),s.pause()},className:"fa fa-pause player-btn"}):r.a.createElement("span",{onClick:function(){O.play(),s.play()},className:"fa fa-play player-btn"}),r.a.createElement("i",{className:"fa fa-forward player-btn",onClick:B}),r.a.createElement("i",{className:"fa fa-refresh player-btn",onClick:function(){"#671ca0"===f?(s.loop=!1,y("black")):"black"===f&&(s.loop=!0,y("#671ca0"))},style:{color:f}})),r.a.createElement("div",{className:"control-time"},r.a.createElement("i",{className:"player-btn"},"0:00"),r.a.createElement("div",{className:"bar1",onClick:function(e){var t;if(document.getElementById("bar")&&(t=document.getElementById("bar").offsetWidth),!s.ended){var a=e.pageX-document.getElementById("bar").offsetLeft;console.log(document.getElementById("bar").offsetLeft),C(a);var n=a*b/t;s.currentTime=n}},id:"bar"},r.a.createElement("div",{className:"progress1",style:{width:"".concat(w,"px")}})),r.a.createElement("i",{className:"duration"},t?"".concat(parseInt(T/60),":").concat(Math.round(T)%60<10?"0"+Math.round(T)%60:parseInt(T)%60,"/").concat(c):"0:00/0:00")),r.a.createElement("div",{className:"controlVolAndInfo"},r.a.createElement("div",{className:"volumer"},r.a.createElement("input",{type:"range",id:"volume",min:"0",max:"100",onChange:function(e){s.volume=.01*e.target.value,q(e.target.value)},className:"volume-range slider"}),s?r.a.createElement("i",{className:0==s.volume?"fa fa-volume-off player-btn volume-btn":"fa fa-volume-up player-btn volume-btn",onClick:function(){s.volume>0?(q(s.volume),s.volume=0):s.volume=A}}):[]),t&&a||0===a?r.a.createElement("div",{className:"song-info"},null!=t[a].artist&&null!=t[a].title?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"inf-artist"},t[a].artist),r.a.createElement("p",{className:"inf-title"},t[a].title)):null==t[a].title&&null!=t[a].artist?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"inf-artist"},t[a].artist),r.a.createElement("p",{className:"inf-title"},"No title")):null==t[a].artist&&null!=t[a].title?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"inf-artist"},"No artist name"),r.a.createElement("p",{className:"inf-title"},t[a].title.slice(0,38))):r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"inf-artist"},"No artist name"),r.a.createElement("p",{className:"inf-title"},"No title"))):[],localStorage.authToken?r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fa fa-list-ul fa-ico list",onClick:function(){return z(!F)},style:{marginLeft:"10px"}})):[]))),F?r.a.createElement(S,{songID:t[a].id}):null)})),x=function(e){var t=Object(n.useState)(),a=Object(m.a)(t,2),l=a[0],c=a[1],i=function(){var e=Object(u.a)(s.a.mark((function e(t,a,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==l){e.next=6;break}return c(!0),e.next=4,fetch("/graphql",{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken},body:JSON.stringify({query:'query media{\n           addToPlaylist(playlistId: "'.concat(a,'" , trackId: "').concat(n,'")\n       }')})});case 4:e.next=10;break;case 6:if(!0!==l){e.next=10;break}return c(!1),e.next=10,fetch("/graphql",{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken},body:JSON.stringify({query:'mutation media{\n            deleteFromPlaylist(playlistId: "'.concat(a,'" , trackId: "').concat(n,'")\n       }')})});case 10:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),o=function(){var e=Object(u.a)(s.a.mark((function e(t,a){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/graphql",{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken},body:JSON.stringify({query:'query media{\n          isitInPlaylist(playlistId: "'.concat(t,'", trackId: "').concat(a,'")\n       }')})});case 2:return n=e.sent,e.next=5,n.json();case 5:r=e.sent,c((function(){return r.data.isitInPlaylist})),console.log(l);case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){return o(e.playlistID,e.songID)}),[]),l||!1===l?r.a.createElement("label",{className:"checkbox-container",style:{"font-size":"15px"}},e.title,r.a.createElement("input",{type:"checkbox",checked:l,onChange:function(t){return i(t,e.playlistID,e.songID)},style:{"font-size":"15px"}}),r.a.createElement("span",{className:"checkmark",style:{"font-size":"15px"}})):null},j=function(e){var t=document.getElementById(e);t.parentNode.removeChild(t)},N=function(){var e=Object(u.a)(s.a.mark((function e(t,a){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/graphql",{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken},body:JSON.stringify({query:'mutation playlist{\n         createPlaylist(playlist: {title: "'.concat(t,'"}){\n           id\n         }\n     }')})});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,console.log(r.data.createPlaylist.id),e.next=9,fetch("/graphql",{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken},body:JSON.stringify({query:'query media{\n       addToPlaylist(playlistId: "'.concat(r.data.createPlaylist.id,'" , trackId: "').concat(a,'")\n   }')})}).then((function(e){return e.json()})).then((function(e){return console.log(e)}));case 9:j("addToPlaylist");case 10:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),w=function(e){var t=e.songId,a=Object(n.useState)(""),l=Object(m.a)(a,2),c=l[0],i=l[1];return r.a.createElement("div",null,r.a.createElement("input",{type:"text",className:"form-control create-playlist","aria-describedby":"playlist",value:c,onChange:function(e){return i(e.target.value)}}),r.a.createElement("button",{disabled:!(c.length>1),onClick:function(){return N(c,t)},style:{display:"inline-block","background-color":"#671ca0","margin-left":"20px"},className:"btn btn-primary"},"Create"),r.a.createElement("small",{class:"form-text text-muted",style:{"font-size":"10px"}},"Type your playlist name here"))},S=Object(d.b)((function(e){return{id:e.login.id}}))((function(e){var t=Object(n.useState)(),a=Object(m.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(!1),o=Object(m.a)(i,2),d=o[0],p=o[1],f=function(){var t=Object(u.a)(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/graphql",{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken},body:JSON.stringify({query:'query media{\n                  getPlaylists(id: "'.concat(e.id,'"){\n                        title,\n                        id\n       }\n              }')})});case 2:return a=t.sent,t.next=5,a.json();case 5:n=t.sent,console.log(n),e.id&&(console.log(n),c((function(){return n.data.getPlaylists.map((function(t){return r.a.createElement(x,{title:t.title,playlistID:t.id,songID:e.songID})}))})));case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(n.useEffect)((function(){return f()}),[]),console.log(e.songID),r.a.createElement("div",{id:"addToPlaylist"},r.a.createElement("div",{className:"addTo-background",onClick:function(){return j("addToPlaylist")}}),r.a.createElement("div",{className:"playlist-option-box"},r.a.createElement("div",{className:"addTo-header"},r.a.createElement("div",{className:"addTo-title",style:{display:"inline-block"}},"Add to ..."),r.a.createElement("i",{class:"fa fa-times addTo-cross",onClick:function(){return j("addToPlaylist")},style:{display:"inline-block"}})),r.a.createElement("div",{className:"addTo-check"},l),r.a.createElement("div",{className:"addTo-createPlaylist"},r.a.createElement("label",{onClick:function(){j("createPlaylist"),p(!0)},id:"createPlaylist"},r.a.createElement("i",{class:"fa fa-plus",style:{"font-size":"23px"}})," ",r.a.createElement("a",{className:"createPlaylist"},"Create new playlist")),d?r.a.createElement(w,{songId:e.songID}):null)))}));function C(e,t,a){var n="string"===typeof t?"key"+t:"keydown",r=document.createEvent("HTMLEvents");for(var l in r.initEvent(n,!0,!1),r.keyCode=e,a)r[l]=a[l];document.dispatchEvent(r)}var I=Object(d.b)((function(e){return{current:e.trackChange.playingTrack.index,isplaying:e.trackChange.isPlaying,id:e.trackChange.playingTrack.id}}))((function(e){var t=Object(n.useState)(),a=Object(m.a)(t,2),l=a[0],c=a[1],i=function(){var t=Object(u.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.id!=e.index){t.next=6;break}O.play(),C(13),O.noshuffle(),t.next=19;break;case 6:return t.next=8,O.playlist(e.playlist);case 8:return console.log(e.playlist),t.next=11,O.pause();case 11:return t.next=13,O.playTrack(e.indexInPlaylist,e.index);case 13:return t.next=15,O.play();case 15:O.loadMetadata(l),O.setPlay(!0),console.log(e.indexInPlaylist,e.current),C(220);case 19:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return new Audio("/song/".concat(e.filename)).onloadedmetadata=function(e){c("".concat(parseInt(e.target.duration/60),":").concat(Math.round(e.target.duration)%60<10?"0"+Math.round(e.target.duration)%60:Math.round(e.target.duration)%60))},e.current==e.indexInPlaylist&&e.id==e.index&&O.loadMetadata(l),r.a.createElement("div",{className:"search-res"},e.isplaying&&e.id==e.index?r.a.createElement("span",{style:{"margin-left":"5px"},className:"fa fa-pause player-btn",onClick:function(e){O.pause(),C(13)}}):r.a.createElement("span",{style:{"margin-left":"5px"},onClick:function(e){i()},className:"fa fa-play player-btn"}),r.a.createElement("p",{display:"inline-block",className:"searchP"},null!=e.artist&&null!=e.title?"".concat(e.artist," - ").concat(e.title," "):null==e.title&&null!=e.artist?"".concat(e.artist," - no title"):null==e.artist&&null!=e.title?"No artist name - ".concat(e.title):"No artist name - no title"))})),P=Object(d.b)((function(e){return{username:e.login.username,id:e.login.id}}))((function(e){var t=Object(n.useState)(),a=Object(m.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(),o=Object(m.a)(i,2),d=o[0],p=o[1],f=function(){var t=Object(u.a)(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.id){t.next=9;break}return t.next=3,fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:'query getImg {\n            getUserAvatar(id: "'.concat(e.id,'"){\n              filename\n            }\n            }\n            ')})});case 3:return a=t.sent,t.next=6,a.json();case 6:n=t.sent,c(r.a.createElement("img",{src:"/img/".concat(n.data.getUserAvatar.filename)})),console.log(n);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),y=Object(n.useState)(),h=Object(m.a)(y,2),g=h[0],b=h[1],E=function(){var e=Object(u.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=11;break}return e.next=3,fetch("/graphql",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:'query search{\n              search(text: "'.concat(t,'"){\n                  filename,\n                  artist,\n                  title, \n                  id\n              }\n           }')})});case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,b((function(){return n.data.search.map((function(e,t){return r.a.createElement(I,{key:t,title:e.title,artist:e.artist,filename:e.filename,index:e.id,playlist:n.data.search,indexInPlaylist:t})}))})),console.log(g),e.next=12;break;case 11:b(null);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){return f()}),[]),"/"==window.location.pathname||"/tracks"==window.location.pathname||"/playlists"==window.location.pathname||"/playlist"==window.location.pathname.slice(0,9)||""==window.location.pathname&&"/login"!=window.location.pathname&&"/uploadfile"!=window.location.pathname?r.a.createElement("div",{className:"header-box"},r.a.createElement("div",{className:"header"},r.a.createElement("nav",{className:"menu"},r.a.createElement("input",{id:"menu__toggle",type:"checkbox",onChange:function(e){return p(e.target.checked)}}),r.a.createElement("label",{className:"menu__btn",htmlFor:"menu__toggle"},d?r.a.createElement("i",{className:"fa fa-times-circle",style:{color:"white",fontSize:"30px"}}):r.a.createElement("i",{className:"fa fa-align-justify",style:{fontSize:"20px"}})),r.a.createElement("a",{href:"/",className:"header-logo"},"SoundOn",r.a.createElement("i",{className:"fa fa-headphones "})),r.a.createElement("ol",{className:"header-menu"},r.a.createElement("li",null,r.a.createElement("a",{href:"/"},"Main")),r.a.createElement("li",null,r.a.createElement("a",{href:"/playlists"},"Playlists")),r.a.createElement("li",null,r.a.createElement("a",{href:"/uploadfile"},"Upload")),r.a.createElement("li",null,r.a.createElement("a",{href:"/tracks"},"Tracks"))),r.a.createElement("div",{className:"search-box"},r.a.createElement("input",{type:"search",className:"header-search",placeholder:"Search something...",onChange:function(e){return E(e.target.value)}}),g?r.a.createElement("div",{className:"search-res-box"},g):[],r.a.createElement("i",{className:"fa fa-search"})),localStorage.authToken&&e.id?r.a.createElement("div",{className:"header-user"},l,r.a.createElement("p",null,e.username),r.a.createElement("i",{className:"fa fa-sign-out logout",onClick:function(){k.dispatch({type:"LOGOUT"}),window.location.reload(!1)}})):r.a.createElement("a",{href:"/login",className:"login-link header-user"},"Login")))):null})),A=function(){var e=Object(u.a)(s.a.mark((function e(t,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/graphql",{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken},body:JSON.stringify({query:'mutation media{\n        deleteFromPlaylist(playlistId: "'.concat(t,'" , trackId: "').concat(a,'")\n   }')})});case 2:alert("Track was deleted"),window.location.reload(!0);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),q=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken},body:JSON.stringify({query:'mutation addToMedia {\n            addToMedia(media: "'.concat(t,'")\n            }\n            ')})});case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken},body:JSON.stringify({query:'mutation addToMedia {\n            deleteFromMedia(mediaId: "'.concat(t,'")\n            }\n            ')})});case 2:e.sent,alert("Track was deleted"),window.location.reload(!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function L(e,t,a){var n="string"===typeof t?"key"+t:"keydown",r=document.createEvent("HTMLEvents");for(var l in r.initEvent(n,!0,!1),r.keyCode=e,a)r[l]=a[l];document.dispatchEvent(r)}var F=Object(d.b)((function(e){return{currentTime:e.trackChange.currentTime,isplaying:e.trackChange.isPlaying,id:e.trackChange.playingTrack.id,shuffle:e.trackChange.shuffle,current:e.trackChange.playingTrack.index}}))((function(e){var t=e.title,a=e.artist,l=e.filename,c=e.index,i=e.playlist,o=e.indexInPlaylist,d=e.currentTime,p=e.id,f=e.isplaying,y=e.playlistId,h=e.current,g=Object(n.useState)(!1),b=Object(m.a)(g,2),E=b[0],k=b[1],v=Object(n.useState)(),T=Object(m.a)(v,2),x=T[0],j=T[1],N=function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p!=c){e.next=5;break}O.play(),L(13),e.next=17;break;case 5:if(p==c){e.next=17;break}return e.next=8,O.playlist(i);case 8:return e.next=10,O.pause();case 10:return e.next=12,O.playTrack(o,c);case 12:return e.next=14,O.play();case 14:O.loadMetadata(x),O.setPlay(!0),L(220);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();new Audio("/song/".concat(l)).onloadedmetadata=function(e){j("".concat(parseInt(e.target.duration/60),":").concat(Math.round(e.target.duration)%60<10?"0"+Math.round(e.target.duration)%60:Math.round(e.target.duration)%60))};return h==o&&p==c&&O.loadMetadata(x),r.a.createElement("div",{className:"miniPlayer-box"},f&&p==c?r.a.createElement("span",{className:"fa fa-pause miniplayer-btn",id:"".concat(c,"-pause"),onClick:function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O.pause(),L(13);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}):r.a.createElement("span",{id:"".concat(c,"-play"),className:"fa fa-play miniplayer-btn",onClick:function(e){N()}}),r.a.createElement("p",{className:"track-artist"},null!=a?"".concat(a):"No artist name"),r.a.createElement("p",{className:"track-title"},null!=t?"".concat(t):"No title"),r.a.createElement("div",{className:"miniplayer-tools"},r.a.createElement("a",{href:"/download/".concat(l),className:"miniplayer-tool"},r.a.createElement("i",{className:"fa fa-arrow-circle-down fa-ico "})),localStorage.authToken?r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fa fa-list-ul fa-ico miniplayer-tool",onClick:function(){return k(!E)}})):[],localStorage.authToken&&"/tracks"!==window.location.pathname?r.a.createElement("i",{className:"fa fa-plus-circle fa-ico miniplayer-tool",onClick:function(){return q(c)}}):[],"/tracks"==window.location.pathname?r.a.createElement("i",{className:"fa fa-times miniplayer-tool",style:{marginleft:"10px",fontSize:"20px"},onClick:function(){return M(c)}}):[],y?r.a.createElement("i",{className:"fa fa-times miniplayer-tool",style:{marginLeft:"10px",fontSize:"20px"},onClick:function(){return A(y,c)}}):[]),p==c?r.a.createElement("i",{className:"miniplayer-tool-duration",style:{marginLeft:"10px",float:"right"}},"".concat(d,"/").concat(x)):r.a.createElement("i",{className:"miniplayer-tool-duration",style:{marginLeft:"10px",float:"right"}},"".concat(x)),E?r.a.createElement(S,{songID:c}):null)})),z=function(e){return r.a.createElement("div",{className:"mainContent-box"},e.media)},B=function(){var e=Object(n.useState)(),t=Object(m.a)(e,2),a=t[0],l=t[1];return Object(n.useEffect)((function(){(function(){var e=Object(u.a)(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/graphql",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"query media{\n                    getAllMedia{\n                                   artist,\n                                   filename,\n                                   title,\n                                   id\n                  }\n                         }"})});case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,l((function(){return a.data.getAllMedia.map((function(e,t){return r.a.createElement(F,{key:t,title:e.title,artist:e.artist,filename:e.filename,index:e.id,playlist:a.data.getAllMedia,indexInPlaylist:t})}))}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(z,{media:a}))},_=function(){O.setPlay(!1);var e=Object(n.useState)(""),t=Object(m.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(""),i=Object(m.a)(c,2),o=i[0],s=i[1];return r.a.createElement("div",{className:"upload"},localStorage.authToken?r.a.createElement(r.a.Fragment,null," ",r.a.createElement("form",{action:"/uploadmedia",acceptCharset:"UTF-8",method:"post",encType:"multipart/form-data",className:"custom-file mb-3"},r.a.createElement("div",{className:"custom-file"},r.a.createElement("input",{type:"file",className:"custom-file-input",id:"customMedia",name:"media",onChange:function(e){return function(e){var t=e.target.files[0];if(console.log(t.size),t&&"audio"==t.type.slice(0,5)&&t.size<=2e7){l(t.name);var a=new FormData;a.append("media",t),fetch("/uploadmedia",{method:"POST",headers:localStorage.authToken?{Authorization:"Bearer "+localStorage.authToken}:{},body:a})}else"audio"!=t.type.slice(0,5)?alert("it must be audio file"):t.size>2e7&&alert("Choose file that file size less 20mb")}(e)}}),r.a.createElement("label",{className:"custom-file-label",htmlFor:"custommedia"},a?"".concat(a):"Choose track"))),r.a.createElement("form",{action:"/upload",acceptCharset:"UTF-8",method:"post",encType:"multipart/form-data",className:"custom-file mb-3"},r.a.createElement("div",{className:"custom-file"},r.a.createElement("input",{type:"file",className:"custom-file-input",id:"customImg",name:"media",onChange:function(e){return function(e){var t=e.target.files[0];if(t&&"image"==t.type.slice(0,5)){s(t.name);var a=new FormData;a.append("myImg",t),fetch("/upload",{method:"POST",headers:localStorage.authToken?{Authorization:"Bearer "+localStorage.authToken}:{},body:a})}else alert("it must be image file")}(e)}}),r.a.createElement("label",{className:"custom-file-label",name:"myImg",htmlFor:"customImg"},o?"".concat(o):"Choose avatar"))),r.a.createElement("button",{type:"button",className:"btn btn-primary",style:{backgroundColor:"#671ca0"}},r.a.createElement("a",{className:"goMain",href:"/"},"Go back"))):r.a.createElement("h3",null,"You must be logged in to upload something",r.a.createElement("br",null),r.a.createElement("a",{href:"/login"},"Click here for login"),r.a.createElement("br",null),r.a.createElement("button",{type:"button",className:"btn btn-primary",style:{backgroundColor:"#671ca0"}},r.a.createElement("a",{className:"goMain",href:"/"},"Go back"))))},D=function(){var e=Object(u.a)(s.a.mark((function e(t,a,n){var r,l,c,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,fetch("/graphql",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:'query login{\n                login(username: "'.concat(t,'", password: "').concat(a,'")\n            }')})});case 3:return r=e.sent,e.next=6,r.json();case 6:return c=e.sent,null==(i=c.data.login)?(k.dispatch({type:"LOGIN_STATUS",status:"Your data is not correct or such user does not exist"}),l=0):(k.dispatch({type:"LOGIN",token:i}),l=1),e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),U=function(){var e=Object(u.a)(s.a.mark((function e(t,a,n){var r,l,c,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,fetch("/graphql",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:'mutation reg{\n                createUser(user: {username: "'.concat(t,'", password: "').concat(a,'"}){\n                    id\n                }\n            }')})});case 3:return r=e.sent,e.next=6,r.json();case 6:return c=e.sent,null==(i=c.data.createUser)?(l=0,k.dispatch({type:"LOGIN_STATUS",status:"This username has already been used"})):(D(t,a,n),l=1,console.log(i)),e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),J=Object(d.b)((function(e){return console.log(e.login),{status:e.login.loginStatus}}))((function(e){O.setPlay(!1);var t=Object(n.useState)(""),a=Object(m.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(""),o=Object(m.a)(i,2),d=o[0],p=o[1],f=Object(n.useState)(!0),y=Object(m.a)(f,2),h=y[0],g=y[1],b=Object(n.useState)(!0),E=Object(m.a)(b,2),k=E[0],v=E[1],T=function(){return l.length>3&&d.length>3&&l.length<=11};return r.a.createElement("div",{className:"login-box"},r.a.createElement("form",null,r.a.createElement("input",{className:"input-login form-control",placeholder:"Type your login here",onChange:function(e){return c(e.target.value)}}),r.a.createElement("div",{className:"eye"},r.a.createElement("input",{type:k?"password":"text",className:"input-login form-control",placeholder:"Type your password here",onChange:function(e){return p(e.target.value)}}),r.a.createElement("i",{className:h?"fa fa-eye-slash":"fa fa-eye",style:{color:"#671ca0",fontSize:"20px"},onMouseDown:function(){g(!h),v(!k)}})),r.a.createElement("button",{disabled:!T(),onClick:function(){var e=Object(u.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(l,d,t);case 2:a=e.sent,t.preventDefault(),a&&(window.location.pathname="/");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),style:{backgroundColor:"rgb(103, 28, 160)"},className:"btn  btn-primary login-btn"},"Register"),r.a.createElement("button",{disabled:!T(),onClick:function(){var e=Object(u.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(l,d,t);case 2:a=e.sent,t.preventDefault(),a&&(window.location.pathname="/");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),style:{backgroundColor:"rgb(103, 28, 160)"},className:"btn  btn-primary login-btn"},"Login"),r.a.createElement("h2",null,e.status?"".concat(e.status):"")))})),Y=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"playlist-box"},r.a.createElement("i",{className:"fa fa-play playlist-btn",onClick:function(){return v.push("/playlist/".concat(e.id))}}),r.a.createElement("p",{className:"playlist-title"},e.title)))},G=function(e){return console.log(e.playlists),r.a.createElement("div",null,r.a.createElement("div",{className:"playlists-box"},r.a.createElement("ul",{className:"playlists"},e.playlists)))},R=Object(d.b)((function(e){return console.log(e),{id:e.login.id}}))((function(e){var t=Object(n.useState)(),a=Object(m.a)(t,2),l=a[0],c=a[1];function i(){return(i=Object(u.a)(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/graphql",{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken},body:JSON.stringify({query:'query media{\n                  getPlaylists(id: "'.concat(e.id,'"){\n                        title,\n                        id\n       }\n              }')})});case 2:return a=t.sent,t.next=5,a.json();case 5:n=t.sent,console.log(n),e.id?(console.log(n),c((function(){return n.data.getPlaylists.map((function(e){return r.a.createElement("li",null,r.a.createElement(Y,{title:e.title,id:e.id}))}))}))):c(r.a.createElement("h3",null,"You must be logged in to check playlist",r.a.createElement("br",null),r.a.createElement("a",{href:"/login"},"Click here for login")));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return console.log(e.id),Object(n.useEffect)((function(){!function(){i.apply(this,arguments)}()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(G,{playlists:l}))})),H=function(e){return r.a.createElement("div",{className:"mainContent-box"},void 0==e.media?r.a.createElement("h3",null,"You must be logged in to upload something",r.a.createElement("br",null),r.a.createElement("a",{href:"/login"},"Click here fo login")):e.media)},K=Object(d.b)((function(e){return{id:e.login.id}}))((function(e){var t=Object(n.useState)(),a=Object(m.a)(t,2),l=a[0],c=a[1],i=function(){var t=Object(u.a)(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/graphql",{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken},body:JSON.stringify({query:'query media{\n                    getUserMedia(id: "'.concat(e.id,'"){\n                         artist,\n                         filename,\n                         title,\n                         id\n        }\n               }')})});case 2:return a=t.sent,t.next=5,a.json();case 5:n=t.sent,console.log(n),e.id&&(0===n.data.getUserMedia.length?c(r.a.createElement("h2",null,"You dont have any added tracks")):c((function(){return n.data.getUserMedia.map((function(e,t){return r.a.createElement(F,{key:t,title:e.title,artist:e.artist,filename:e.filename,index:e.id,playlist:n.data.getUserMedia,indexInPlaylist:t})}))})));case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(n.useEffect)((function(){return i()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(H,{media:l}),r.a.createElement(T,null))})),W=function(e){return r.a.createElement("div",{className:"mainContent-box"},e.media)},V=function(e){var t=Object(n.useState)(),a=Object(m.a)(t,2),l=a[0],c=a[1],i=function(){var t=Object(u.a)(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!localStorage.authToken){t.next=11;break}return t.next=3,fetch("/graphql",{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken},body:JSON.stringify({query:'query media{\n              getTracksFromPlaylist(id: "'.concat(e.match.params.playlist,'"){\nfilename,\nid,\ntitle,\nartist\n}\n           }')})});case 3:return a=t.sent,t.next=6,a.json();case 6:n=t.sent,console.log(n),null!=n.data.getTracksFromPlaylist?0!==n.data.getTracksFromPlaylist.length?c((function(){return n.data.getTracksFromPlaylist.map((function(t,a){return r.a.createElement(F,{key:a,title:t.title,playlistId:e.match.params.playlist,artist:t.artist,filename:t.filename,index:t.id,playlist:n.data.getTracksFromPlaylist,indexInPlaylist:a})}))})):0==n.data.getTracksFromPlaylist.length&&c(r.a.createElement("h3",null,"Noone track in this playlist")):null==n.data.getTracksFromPlaylist&&c(r.a.createElement("h3",null,"You dont have permissions for this playlist")),t.next=12;break;case 11:c(r.a.createElement("h3",null,"You must be logged in to check playlist",r.a.createElement("br",null),r.a.createElement("a",{href:"/login"},"Click here for login")));case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(n.useEffect)((function(){return i()}),[]),r.a.createElement("div",null,r.a.createElement(W,{media:l}))};k.dispatch({type:"CHECK_LOGIN"});var X=Object(d.b)((function(e){return{isItPlayed:e.trackChange.isItPlaying}}))((function(e){return e.isItPlayed?r.a.createElement(T,null):null})),$=function(){return r.a.createElement(d.a,{store:k},r.a.createElement(i.b,{history:v},r.a.createElement(P,null),r.a.createElement(i.c,null,r.a.createElement(i.a,{path:"/uploadfile",component:_,exact:!0}),r.a.createElement(i.a,{path:"/",component:B,exact:!0}),r.a.createElement(i.a,{path:"/playlists",component:R,exact:!0}),r.a.createElement(i.a,{path:"/login",component:J,exact:!0}),r.a.createElement(i.a,{path:"/tracks",component:K,exact:!0}),r.a.createElement(i.a,{path:"/playlist/:playlist",component:V,exact:!0}))),r.a.createElement(X,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},7:function(e,t,a){}},[[29,1,2]]]);
//# sourceMappingURL=main.f402e861.chunk.js.map